angular.module("app").directive("uiNav",["$timeout",function(){return{restrict:"AC",link:function(e,a){var t,o=$(window),n=768,s=$(".app-aside"),i=".dropdown-backdrop";a.on("click","a",function(e){t&&t.trigger("mouseleave.nav");var a=$(this);a.parent().siblings(".active").toggleClass("active"),a.next().is("ul")&&a.parent().toggleClass("active")&&e.preventDefault(),a.next().is("ul")||o.width()<n&&$(".app-aside").removeClass("show off-screen")}),a.on("mouseenter","a",function(e){if(t&&t.trigger("mouseleave.nav"),$("> .nav",s).remove(),!(!$(".app-aside-fixed.app-aside-folded").length||o.width()<n||$(".app-aside-dock").length)){var a,r=$(e.target),p=$(window).height(),v=50,c=150;!r.is("a")&&(r=r.closest("a")),r.next().is("ul")&&(t=r.next(),r.parent().addClass("active"),a=r.parent().position().top+v,t.css("top",a),a+t.height()>p&&t.css("bottom",0),a+c>p&&t.css("bottom",p-a-v).css("top","auto"),t.appendTo(s),t.on("mouseleave.nav",function(){$(i).remove(),t.appendTo(r.parent()),t.off("mouseleave.nav").css("top","auto").css("bottom","auto"),r.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(e){e&&e.trigger("mouseleave.nav")}))}}),s.on("mouseleave",function(){t&&t.trigger("mouseleave.nav"),$("> .nav",s).remove()})}}}]);