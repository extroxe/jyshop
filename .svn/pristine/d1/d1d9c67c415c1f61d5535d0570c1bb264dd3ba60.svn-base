(function(){var n;n=angular.module("angularBootstrapNavTree",[]),n.directive("abnTree",["$timeout",function(n){return{restrict:"E",template:'<ul class="nav nav-list nav-pills nav-stacked abn-tree">\n  <li ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-animate="\'abn-tree-animate\'" ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\')" class="abn-tree-row">\n    <a ng-click="user_clicks_branch(row.branch)">\n      <i ng-class="row.tree_icon" ng-click="row.branch.expanded = !row.branch.expanded" class="indented tree-icon"> </i>\n      <span class="indented tree-label">{{ row.label }} </span>\n    </a>\n  </li>\n</ul>',replace:!0,scope:{treeData:"=",onSelect:"&",initialSelection:"@",treeControl:"="},link:function(e,r,t){var l,i,a,c,u,o,d,s,_,h,f;if(l=function(n){return void console.log("ERROR:"+n)},null==t.iconExpand&&(t.iconExpand="icon-plus  glyphicon glyphicon-plus  fa fa-plus"),null==t.iconCollapse&&(t.iconCollapse="icon-minus glyphicon glyphicon-minus fa fa-minus"),null==t.iconLeaf&&(t.iconLeaf="icon-file  glyphicon glyphicon-file  fa fa-file"),null==t.expandLevel&&(t.expandLevel="3"),a=parseInt(t.expandLevel,10),!e.treeData)return void alert("no treeData defined for the tree!");if(null==e.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");e.treeData=[treeData]}return u=function(n){var r,t,l,i,a,c;for(r=function(e,t){var l,i,a,c,u;if(n(e,t),null!=e.children){for(c=e.children,u=[],i=0,a=c.length;a>i;i++)l=c[i],u.push(r(l,t+1));return u}},a=e.treeData,c=[],l=0,i=a.length;i>l;l++)t=a[l],c.push(r(t,1));return c},h=null,_=function(r){if(!r)return null!=h&&(h.selected=!1),void(h=null);if(r!==h){if(null!=h&&(h.selected=!1),r.selected=!0,h=r,i(r),null!=r.onSelect)return n(function(){return r.onSelect(r)});if(null!=e.onSelect)return n(function(){return e.onSelect({branch:r})})}},e.user_clicks_branch=function(n){return n!==h?_(n):void 0},o=function(n){var e;return e=void 0,n.parent_uid&&u(function(r){return r.uid===n.parent_uid?e=r:void 0}),e},c=function(n,e){var r;return r=o(n),null!=r?(e(r),c(r,e)):void 0},i=function(n){return c(n,function(n){return n.expanded=!0})},e.tree_rows=[],s=function(){var n,r,l,i,a,c;for(u(function(n){return n.uid?void 0:n.uid=""+Math.random()}),console.log("UIDs are set."),u(function(n){var e,r,t,l,i;if(angular.isArray(n.children)){for(l=n.children,i=[],r=0,t=l.length;t>r;r++)e=l[r],i.push(e.parent_uid=n.uid);return i}}),e.tree_rows=[],u(function(n){var e,r;return n.children?n.children.length>0?(r=function(n){return"string"==typeof n?{label:n,children:[]}:n},n.children=function(){var t,l,i,a;for(i=n.children,a=[],t=0,l=i.length;l>t;t++)e=i[t],a.push(r(e));return a}()):void 0:n.children=[]}),n=function(r,l,i){var a,c,u,o,d,s,_;if(null==l.expanded&&(l.expanded=!1),u=l.children&&0!==l.children.length?l.expanded?t.iconCollapse:t.iconExpand:t.iconLeaf,e.tree_rows.push({level:r,branch:l,label:l.label,tree_icon:u,visible:i}),null!=l.children){for(s=l.children,_=[],o=0,d=s.length;d>o;o++)a=s[o],c=i&&l.expanded,_.push(n(r+1,a,c));return _}},a=e.treeData,c=[],l=0,i=a.length;i>l;l++)r=a[l],c.push(n(1,r,!0));return c},e.$watch("treeData",s,!0),null!=t.initialSelection&&u(function(e){return e.label===t.initialSelection?n(function(){return _(e)}):void 0}),d=e.treeData.length,console.log("num root branches = "+d),u(function(n,e){return n.level=e,n.expanded=n.level<a}),null!=e.treeControl&&angular.isObject(e.treeControl)?(f=e.treeControl,f.expand_all=function(){return u(function(n){return n.expanded=!0})},f.collapse_all=function(){return u(function(n){return n.expanded=!1})},f.get_first_branch=function(){return d=e.treeData.length,d>0?e.treeData[0]:void 0},f.select_first_branch=function(){var n;return n=f.get_first_branch(),f.select_branch(n)},f.get_selected_branch=function(){return h},f.get_parent_branch=function(n){return o(n)},f.select_branch=function(n){return _(n),n},f.get_children=function(n){return n.children},f.select_parent_branch=function(n){var e;return null==n&&(n=f.get_selected_branch()),null!=n&&(e=f.get_parent_branch(n),null!=e)?(f.select_branch(e),e):void 0},f.add_branch=function(n,r){return null!=n?(n.children.push(r),n.expanded=!0):e.treeData.push(r),r},f.add_root_branch=function(n){return f.add_branch(null,n),n},f.expand_branch=function(n){return null==n&&(n=f.get_selected_branch()),null!=n?(n.expanded=!0,n):void 0},f.collapse_branch=function(n){return null==n&&(n=h),null!=n?(n.expanded=!1,n):void 0},f.get_siblings=function(n){var r,t;return null==n&&(n=h),null!=n?(r=f.get_parent_branch(n),t=r?r.children:e.treeData):void 0},f.get_next_sibling=function(n){var e,r;return null==n&&(n=h),null!=n&&(r=f.get_siblings(n),d=r.length,e=r.indexOf(n),d>e)?r[e+1]:void 0},f.get_prev_sibling=function(n){var e,r;return null==n&&(n=h),r=f.get_siblings(n),d=r.length,e=r.indexOf(n),e>0?r[e-1]:void 0},f.select_next_sibling=function(n){var e;return null==n&&(n=h),null!=n&&(e=f.get_next_sibling(n),null!=e)?f.select_branch(e):void 0},f.select_prev_sibling=function(n){var e;return null==n&&(n=h),null!=n&&(e=f.get_prev_sibling(n),null!=e)?f.select_branch(e):void 0},f.get_first_child=function(n){var e;return null==n&&(n=h),null!=n&&(null!=(e=n.children)?e.length:void 0)>0?n.children[0]:void 0},f.get_closest_ancestor_next_sibling=function(n){var e,r;return e=f.get_next_sibling(n),null!=e?e:(r=f.get_parent_branch(n),f.get_closest_ancestor_next_sibling(r))},f.get_next_branch=function(n){var e;return null==n&&(n=h),null!=n?(e=f.get_first_child(n),null!=e?e:e=f.get_closest_ancestor_next_sibling(n)):void 0},f.select_next_branch=function(n){var e;return null==n&&(n=h),null!=n&&(e=f.get_next_branch(n),null!=e)?(f.select_branch(e),e):void 0},f.last_descendant=function(n){var e;return d=n.children.length,0===d?n:(e=n.children[d-1],f.last_descendant(e))},f.get_prev_branch=function(n){var e,r;return null==n&&(n=h),null!=n?(r=f.get_prev_sibling(n),null!=r?f.last_descendant(r):e=f.get_parent_branch(n)):void 0},f.select_prev_branch=function(n){var e;return null==n&&(n=h),null!=n&&(e=f.get_prev_branch(n),null!=e)?(f.select_branch(e),e):void 0}):void 0}}}])}).call(this);