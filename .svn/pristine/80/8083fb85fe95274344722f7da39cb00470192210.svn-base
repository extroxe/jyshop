"use strict";app.controller("modalArticleCtrl",["$scope","$modalInstance","_jiyin","params","FileUploader","dataToURL",function(t,e,i,n){t.infoList=n.infoList,t.title=n.title,t.ael=n.ael,t.items=["fontname","fontsize","forecolor","bold","underline","emoticons","link"],t.getStatus=function(){i.dataPost("admin/system_code_admin/get_by_type/article_status").then(function(e){t.statusList=e})},t.getStatus(),t.$on("attachment_id",function(e,i){t.infoList.thumbnail_id=i}),t.cancel=function(){e.dismiss("cancel")},t.ok=function(){return t.infoList.title?t.infoList.abstract?t.infoList.content?t.infoList.status_id?t.infoList.thumbnail_id?void e.close(t.infoList):void i.msg("e","还没有上传图片"):void i.msg("e","状态不能为空"):void i.msg("e","文章内容不能为空"):void i.msg("e","文章摘要不能为空"):void i.msg("e","文章标题不能为空")}}]),app.controller("FileUploadCtrl",["$scope","FileUploader","_jiyin","dataToURL",function(t,e,i,n){var o=t.uploader=new e({url:SITE_URL+"attachment/up_attachment"});o.filters.push({name:"customFilter",fn:function(){return this.queue.length<2}}),t.upload=function(e){i.fileMd5(e._file).then(function(a){i.dataPost("attachment/check_md5",n({md5_code:a.md5Code})).then(function(i){1==i.exist?(t.$emit("attachment_id",i.attachment_id),e.file.size=e._file.size,e.progress=100,e.isSuccess=!0,e.isUploaded=!0,e.uploader.progress+=100/o.queue.length):e.upload()})})},t.uploadAll=function(){angular.forEach(o.queue,function(e){i.fileMd5(e._file).then(function(a){i.dataPost("attachment/check_md5",n({md5_code:a.md5Code})).then(function(i){1==i.exist?(t.$emit("attachment_id",i.attachment_id),e.file.size=e._file.size,e.progress=100,e.isSuccess=!0,e.isUploaded=!0,o.progress+=100/o.queue.length):e.upload()})})})},o.onSuccessItem=function(e,i){t.$emit("attachment_id",i.attachment_id)},t.$on("clearQueue",function(){o.clearQueue()})}]);