app.controller("memberCtrl",["$scope","_jiyin","dataToURL",function(e,t,a){e.memberList={},e.inputPage=1,e.keyword="",e.upload=function(){$("#upload").modal("show")},e.ok=function(){$("#upload").modal("hide")},e.$on("memberList",function(t,a){e.memberList=a}),e.$on("totalPage",function(t,a){e.totalPage=a}),e.search=function(){e.inputPage=1,t.dataPost("admin/user_admin/get_page_info/",a({page:e.inputPage,keyword:e.keyword})).then(function(t){e.memberList=t.data,e.totalPage=t.total_page})},$("#search").keydown(function(t){13==t.keyCode&&e.search()}),e.getData=function(){t.dataPost("admin/user_admin/get_page_info/",a({page:e.inputPage,keyword:e.keyword})).then(function(t){e.memberList=t.data,e.totalPage=t.total_page})},e.getData(),e.addList=function(){e.title="增加数据",t.modal({tempUrl:"/source/admin/tpl/modal/modal-userInfo.html",tempCtrl:"modalUserCtrl",ok:e.add,size:"lg",params:{title:e.title,infoList:{},ael:"add"}})},e.add=function(n){t.dataPost("admin/user_admin/add_info",a(n)).then(function(a){1==a.success?(t.msg("s",a.msg),e.getData()):t.msg("e",a.error)})},e.editList=function(a){e.title="编辑数据",t.modal({tempUrl:"/source/admin/tpl/modal/modal-userInfo.html",tempCtrl:"modalUserCtrl",ok:e.edit,size:"lg",params:{title:e.title,infoList:a,ael:"edit"}})},e.edit=function(n){t.dataPost("admin/user_admin/update_info",a(n)).then(function(a){1==a.success?(t.msg("s",a.msg),e.getData()):t.msg("e",a.error)})},e.deleteData=function(n){confirm("确认删除这条数据吗?")&&t.dataPost("admin/user_admin/soft_delete",a({id:n.id})).then(function(a){1==a.success?(t.msg("s","删除成功"),e.getData()):t.msg("e",a.msg)})},e.nextPage=function(){e.inputPage<e.totalPage?(e.inputPage++,e.getData()):t.msg("e","当前是最后一页")},e.previousPage=function(){e.inputPage>1?(e.inputPage--,e.getData()):t.msg("e","当前是第一页")},e.firstPage=function(){e.inputPage=1,e.getData()},e.lastPage=function(){e.inputPage=e.totalPage,e.getData()},e.selectPage=function(t){e.inputPage=t,e.getData()}}]),app.controller("memberFileUploadCtrl",["$scope","FileUploader","_jiyin","dataToURL",function(e,t,a,n){var o=e.uploader=new t({url:SITE_URL+"admin/user_admin/batch_up_user_data"});o.filters.push({name:"customFilter",fn:function(){return this.queue.length<2}}),e.upload=function(e){return o.queue.length>1?void a.msg("e","只能上传一个文件"):void e.upload()},e.uploadAll=function(){return o.queue.length>1?void a.msg("e","只能上传一个文件"):void angular.forEach(o.queue,function(e){e.upload()})},o.onSuccessItem=function(t,o){if(1==o.success){if(a.msg("s",o.msg),o.error){var i="";angular.forEach(o.error,function(e){i=i+e+","}),alert(i)}a.dataPost("admin/user_admin/get_page_info/",n({page:1})).then(function(t){e.$emit("memberList",t.data),e.$emit("totalPage",t.total_page)})}else a.msg("e",o.msg)},e.$on("clearQueue",function(){o.clearQueue()})}]);