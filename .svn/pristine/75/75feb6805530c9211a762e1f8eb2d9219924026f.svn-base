app.controller("postCtrl",["$scope","_jiyin","dataToURL","$stateParams","$state",function(t,a,i,o,n){t.postList={},t.inputPage=1,t.post_bar_id=0,t.infoList={},t.keyword="",t.search=function(){t.inputPage=1,a.dataPost("admin/post_admin/paginate/"+t.inputPage+"/10",i({post_bar_id:t.post_bar_id,keyword:t.keyword})).then(function(a){t.postList=a.data,t.totalPage=a.total_page})},$("#search").keydown(function(a){13==a.keyCode&&t.search()}),t.show=function(){t.title="增加",t.add=!0,t.infoList={},t.infoList.is_stickied=0,$("#post").modal("show")},t.edit=function(a){t.title="编辑",t.infoList=a,t.add=!1,$("#post").modal("show")},t.getAll=function(){t.post_bar_id=0,t.getData()},t.getSome=function(){t.inputPage=1,$("#po").modal("show")},t.getPost=function(){a.dataPost("admin/post_admin/paginate/"+t.inputPage+"/10",i({post_bar_id:t.post_bar_id,keyword:t.keyword})).then(function(a){t.postList=a.data,t.totalPage=a.total_page,$("#po").modal("hide")})},t.getBar=function(){a.dataPost("admin/post_bar_admin/get_post_bar/1/999").then(function(a){t.postbarList=a.data})},t.getBar(),t.getStatus=function(){a.dataPost("admin/system_code_admin/get_by_type/post_status").then(function(a){t.statusList=a})},t.getStatus(),t.ok=function(){1==t.add?a.dataPost("admin/post_admin/add",i(t.infoList)).then(function(i){1==i.success?(a.msg("s","添加成功"),t.getData(),$("#post").modal("hide")):a.msg("e",i.msg+",带*号为必填，请先填写信息")}):a.dataPost("admin/post_admin/update",i(t.infoList)).then(function(i){1==i.success?(a.msg("s","修改成功"),t.getData(),$("#post").modal("hide")):a.msg("e",i.msg+",带*号为必填，请先填写信息")})},t.stick=function(o){a.dataPost("admin/post_admin/stickied",i({id:o.id,bar_id:o.post_bar_id,is_stickied:o.is_stickied})).then(function(i){1==i.success?(a.msg("s","修改成功"),t.getData()):a.msg("e",i.msg)})},t.cancel=function(){$("#post").modal("hide")},t.look=function(t){n.go("app.comment",{id:t.id})},t.getData=function(){a.dataPost("admin/post_admin/paginate/"+t.inputPage+"/10",i({post_bar_id:t.post_bar_id,keyword:t.keyword})).then(function(a){t.postList=a.data,t.totalPage=a.total_page,$("#po").modal("hide")})},t.getData(),t.deleteData=function(o){confirm("确认删除这条数据吗?")&&a.dataPost("admin/post_admin/delete",i({id:o.id})).then(function(i){1==i.success?(a.msg("s","删除成功"),t.getData()):a.msg("e",i.msg)})},t.nextPage=function(){t.inputPage<t.totalPage?(t.inputPage++,t.getData()):a.msg("e","当前是最后一页")},t.previousPage=function(){t.inputPage>1?(t.inputPage--,t.getData()):a.msg("e","当前是第一页")},t.firstPage=function(){t.inputPage=1,t.getData()},t.lastPage=function(){t.inputPage=t.totalPage,t.getData()},t.selectPage=function(a){t.inputPage=a,t.getData()}}]);