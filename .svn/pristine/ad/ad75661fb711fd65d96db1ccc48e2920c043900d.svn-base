app.controller("couponCtrl",["$scope","_jiyin","dataToURL","$stateParams","$state",function(t,a,n,e,o){t.couponList={},t.inputPage=1,t.getData=function(){a.dataGet("admin/coupon_admin/paginate/"+t.inputPage+"/10").then(function(a){t.totalPage=0==a.total_page?1:a.total_page,t.couponList=a.data})},t.getData(),t.addList=function(){t.title="增加数据",a.modal({tempUrl:"/source/admin/tpl/modal/modal-coupon.html",tempCtrl:"modalCouponCtrl",ok:t.add,size:"lg",params:{title:t.title,infoList:{},ael:"add"}})},t.add=function(e){a.dataPost("admin/coupon_admin/add",n(e)).then(function(n){1==n.success?(a.msg("s",n.msg),t.getData()):a.msg("e",n.msg)})},t.editList=function(n){t.title="编辑数据",a.modal({tempUrl:"/source/admin/tpl/modal/modal-coupon.html",tempCtrl:"modalCouponCtrl",ok:t.edit,size:"lg",params:{title:t.title,infoList:n,ael:"edit"}})},t.edit=function(e){a.dataPost("admin/coupon_admin/update",n(e)).then(function(n){1==n.success?(a.msg("s",n.msg),t.getData()):a.msg("e",n.msg)})},t.deleteData=function(e){confirm("确认删除这条数据吗?")&&a.dataPost("admin/coupon_admin/delete",n({id:e.id})).then(function(n){1==n.success?(a.msg("s","删除成功"),t.getData()):a.msg("e",n.msg)})},t.grant=function(e){confirm("确定要发放该优惠券吗?")&&(e.status_id=1,a.dataPost("admin/coupon_admin/update",n(e)).then(function(n){1==n.success?(a.msg("s",n.msg),t.getData()):a.msg("e",n.msg)}))},t.lookData=function(t){o.go("app.couponUser",{id:t.id})},t.nextPage=function(){t.inputPage<t.totalPage?(t.inputPage++,t.getData()):a.msg("e","当前是最后一页")},t.previousPage=function(){t.inputPage>1?(t.inputPage--,t.getData()):a.msg("e","当前是第一页")},t.firstPage=function(){t.inputPage=1,t.getData()},t.lastPage=function(){t.inputPage=t.totalPage,t.getData()},t.selectPage=function(a){t.inputPage=a,t.getData()}}]);